
# By-lab Meta-analysis 

```{r}
forest_data <- readRDS(here("processed_data/cached_data/forest_data.Rds"))
es_df <- forest_data %>% filter(lab == "Meta-analytic estimate") %>% mutate_if(is.numeric, round, 2)
```


We computed a single effect size per lab and fit an intercept-only mixed-effect meta-regression to estimate the overall IDS preference across sites. This approach provides a comparable summary of results across sites. Even with a standardized protocol, sites differ in their cultures, recruitment pools, equipment, and experimenter behavior. A random-effects meta-analysis treats those differences as legitimate heterogeneity rather than noise, yielding a conservative estimate of the cross-lab mean and its uncertainty.

To do so, we calculated each infant’s mean IDS–ADS difference score ^[ Due to an experimental procedure error, infants at the South Africa site were not always presented with complete IDS–ADS stimulus pairs; in some cases, the same stimulus was played multiple times. While this issue did not affect the random-effects model in the main analysis, it does impact the present meta-analysis. We therefore trimmed the data by (1) retaining only the first presentation of each trial and (2) including only trials in which both the IDS and ADS versions were presented. The trimmed data includes 176 trials from 28 infants.], standardized these within lab to obtain effect sizes, and estimated their sampling variances. These lab-level estimates were then entered into a REML random-effects model to produce the pooled effect size and 95% confidence interval (Figure 1). The meta-analytic effect size is `r es_df$effects`[`r es_df$effects.cil`, `r  es_df$effects.cih`], which is numerically smaller than the .35 [0.29, 0.42] reported in MB1 (Manybabies Consortium, 2020) but these estimates are not directly comparable due to the different method and age distribution in the current project (cf. Mathur et al., 2024).


```{r fig.cap = "Forest plot of lab-level standardized effect sizes (for the IDS–ADS preference. Points represent individual country estimates, with size proportional to the inverse of their sampling variance; horizontal bars show 95% confidence intervals. The meta-analytic aggregate (top, red) is from an intercept-only random-effects model."}

ggplot(forest_data, aes(x = country, y = effects,
                        color = country == "Meta-analytic estimate")) +
  geom_hline(yintercept = 0, linetype = "dashed", color = "grey") +
  geom_pointrange(aes(ymin = effects - sqrt(variances) * 1.96,
                      ymax = effects + sqrt(variances) * 1.96,
                      group = index),
                  alpha = .5, position = position_dodge(width = .5)) +
  geom_point(data = dplyr::filter(forest_data, lab != "Meta-analytic estimate"),
             aes(size = inverse_vars, group = index),
             alpha = .5, position = position_dodge(width = .5)) +
  geom_point(data = dplyr::filter(forest_data, lab == "Meta-analytic estimate"),
             pch = 5) +
  geom_linerange(data = dplyr::filter(forest_data, lab == "Meta-analytic estimate"),
                 aes(ymin = effects.cil, ymax = effects.cih), alpha = .5) +
  coord_flip() +
  scale_size_continuous(guide = FALSE) +
  scale_color_manual(values = c(`TRUE` = "red", `FALSE` = "black"), guide = FALSE)+
  xlab("Country") + ylab("Effect size") +
  theme(axis.text.y = element_text(size = 6)) +
  ggthemes::theme_few()
```

